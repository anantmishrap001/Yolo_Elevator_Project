<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Smart Lift System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #111;
            color: white;
            text-align: center;
            padding-top: 20px;
        }
        h1 {
            color: #8a2be2;
        }
        .container {
            display: flex;
            justify-content: center;
            gap: 30px;
            align-items: center;
        }
        .video {
            border: 4px solid #8a2be2;
            border-radius: 15px;
        }
        .lift {
            width: 200px;
            height: 300px;
            border: 4px solid #8a2be2;
            border-radius: 10px;
            position: relative;
            background-color: #222;
            overflow: hidden;
        }
        .door {
            position: absolute;
            width: 50%;
            height: 100%;
            top: 0;
            background-color: gray;
            transition: 0.6s;
        }
        #leftDoor {
            left: 0;
        }
        #rightDoor {
            right: 0;
        }
        .led {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin: 10px auto;
        }
    </style>
</head>
<body>
    <h1>Smart Lift System</h1>
    <div id="info">
        <h2>People in Lift: <span id="peopleCount">0</span></h2>
        <h3>Door Status: <span id="doorStatus">Closed</span></h3>
        <div class="led" id="ledLight"></div>
    </div>

    <div class="container">
        <img src="{{ url_for('video_feed') }}" width="600" class="video">
        <div class="lift">
            <div id="leftDoor" class="door"></div>
            <div id="rightDoor" class="door"></div>
        </div>
    </div>

    <script>
        async function fetchData() {
            const res = await fetch('/get_data');
            const data = await res.json();
            if (data.length > 0) {
                const last = data[data.length - 1];
                document.getElementById('peopleCount').innerText = last.People_Count;
                document.getElementById('doorStatus').innerText = last.Door_Status;

                const led = document.getElementById('ledLight');
                const leftDoor = document.getElementById('leftDoor');
                const rightDoor = document.getElementById('rightDoor');

                if (last.Door_Status === 'Open') {
                    led.style.backgroundColor = 'green';
                    leftDoor.style.transform = 'translateX(-100%)';
                    rightDoor.style.transform = 'translateX(100%)';
                } else {
                    led.style.backgroundColor = 'red';
                    leftDoor.style.transform = 'translateX(0)';
                    rightDoor.style.transform = 'translateX(0)';
                }
            }
        }
        setInterval(fetchData, 1000);
    </script>
</body>
</html>
